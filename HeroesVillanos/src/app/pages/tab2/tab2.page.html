<ion-header>
  <ion-toolbar color="light" style="margin-bottom: 20px; padding-top: 20px; padding-bottom: 20px;">
    <ion-title style="font-size: 1.5rem; font-weight: bold;">Favorites</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-card style="margin: 20px; background: rgba(7, 7, 7, 0.2); border-radius: 16px; box-shadow: 0 2px 20px rgba(0, 0, 0, 0.5); backdrop-filter: blur(5px); border: 1px solid rgba(255, 255, 255, 0.3);" *ngIf="favoriteCharacters.length > 0">
    <ion-card-header>
      <ion-card-title style="font-size: 1rem; font-weight: bold;">Statistics</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-grid>
        <ion-row>
          <ion-col size="3" class="ion-text-center">
            <div style="font-size: 1.5rem; font-weight: bold; color: var(--secondary);">{{ favoriteCharacters.length }}</div>
            <div style="font-size: 0.9rem; color: #999;">Total</div>
          </ion-col>
          <ion-col size="3" class="ion-text-center">
            <div style="font-size: 1.5rem; font-weight: bold; color: #4CAF50;">{{ countByAffiliation('Hero') }}</div>
            <div style="font-size: 0.9rem; color: #999;">Heroes</div>
          </ion-col>
          <ion-col size="3" class="ion-text-center">
            <div style="font-size: 1.5rem; font-weight: bold; color: #FF6B6B;">{{ countByAffiliation('Villain') }}</div>
            <div style="font-size: 0.9rem; color: #999;">Villains</div>
          </ion-col>
          <ion-col size="3" class="ion-text-center">
            <div style="font-size: 1.5rem; font-weight: bold; color: #FFB84D;">{{ countByAffiliation('Neutral') }}</div>
            <div style="font-size: 0.9rem; color: #999;">Neutral</div>
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-card-content>
  </ion-card>

  <div style="view-timeline: --reveal;">
    <ion-grid>
      @if (favoriteCharacters.length > 0) {
        @for (character of favoriteCharacters; track character.id) {
          <ion-row>
            <ion-col size="12">
              <ion-card class="card-custom"> 
                <ion-card-content (click)="showLoading(character.id)" style="padding-left: 8px; padding-right: 0px; padding-right: 0;">
                  <ion-row style="padding: 0px;">
                    <ion-col size="5" class="card-avatar" style="padding: 0px;">
                      <div class="card-avatar" style="padding: 0px;">
                        <ion-img 
                        [src]="character.images" 
                        alt="{{character.name}}" 
                        loadingSpinner="crescent"
                        loading="lazy"
                        ></ion-img>
                      </div>
                    </ion-col>
                    
                    <ion-col size="7" class="card-details">
                      
                      <div class="name">
                        <strong>{{ character.name}}</strong>
                      </div>
                      <div class="occupation">
                        {{character.appearance}} {{character.afiliation}} {{character.universe}}
                      </div>
                      
                      <div class="card-about">
                        <div class="item">
                            <span><strong>{{character.weight}}</strong></span>
                            <span class="label">Weight</span>
                        </div>
                        <div class="item">
                            <span><strong>{{character.height}}</strong></span>
                            <span class="label">Height</span>
                        </div>
                        <div class="item">
                            <span><strong>{{character.ratingPower}}</strong></span>
                            <span class="label">Power</span>
                        </div>
                      </div>
                      
                      <div class="skills">
                        <span class="value">
                          <strong>{{character.mainPower}}</strong>. {{character.groupAffiliation}}
                        </span>
                      </div>
                    </ion-col>
                    
                    <ion-col size="12" class="ion-text-right" style="padding: 8px 8px 0 0;">
                      <ion-button (click)="removeFavorite(character.id); $event.stopPropagation()" color="danger" size="small" fill="outline">
                        <ion-icon name="trash" slot="start"></ion-icon>
                        Remove
                      </ion-button>
                    </ion-col>
                  </ion-row>
                </ion-card-content>
              </ion-card>
            </ion-col>
          </ion-row>
        }
      } @else {
        <ion-row style="height: 60vh; display: flex; align-items: center; justify-content: center;">
          <ion-col size="12" class="ion-text-center">
            <ion-icon name="heart-outline" style="font-size: 4rem; color: var(--primary);"></ion-icon>
            <h2 style="margin-top: 20px; color: #999;">No favorites yet</h2>
            <p style="color: #777;">Add characters to your favorites from the Explore tab</p>
          </ion-col>
        </ion-row>
      }
    </ion-grid>
  </div>
  <ion-infinite-scroll (ionInfinite)="getFavorites($event)" >
    <ion-infinite-scroll-content loadingText="Please wait..." loadingSpinner="bubbles"></ion-infinite-scroll-content>
  </ion-infinite-scroll> 
</ion-content>
